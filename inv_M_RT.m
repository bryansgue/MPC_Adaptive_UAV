function [aux] = inv_M_RT(X,q)
%UNTITLED Summary of this function goes here
%   Detailed explanation goes here
phi = q(4);
theta = q(5);
psi = q(6);

m1 = X(1);
Ixx = X(2);
Iyy = X(3);
Izz = X(4);

Kp_T = X(16);


aux = [1/m1,    0, -(Kp_T*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)))/(m1*(m1 + Kp_T*cos(phi)*cos(theta))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0;...
   0, 1/m1,  (Kp_T*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)))/(m1*(m1 + Kp_T*cos(phi)*cos(theta))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0;...
   0,    0,                                                              1/(m1 + Kp_T*cos(phi)*cos(theta)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0;...
   0,    0,                                                                                             0, -(Ixx*Izz + Ixx*Iyy*cos(phi)^2 - Ixx*Izz*cos(phi)^2 - Ixx*Izz*cos(theta)^2 + Iyy*Izz*cos(theta)^2 + Iyy^2*cos(phi)^2*cos(theta)^2 - Iyy^2*cos(phi)^4*cos(theta)^2 + Izz^2*cos(phi)^2*cos(theta)^2 - Izz^2*cos(phi)^4*cos(theta)^2 - Ixx*Iyy*cos(phi)^2*cos(theta)^2 + Ixx*Izz*cos(phi)^2*cos(theta)^2 - 2*Iyy*Izz*cos(phi)^2*cos(theta)^2 + 2*Iyy*Izz*cos(phi)^4*cos(theta)^2 - Iyy^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 - Izz^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 + 2*Iyy*Izz*cos(phi)^2*cos(theta)^2*sin(phi)^2)/(Ixx*(Ixx*Izz*cos(phi)^2 - Ixx*Iyy*cos(phi)^2 - Ixx*Izz + Ixx*Izz*cos(theta)^2 - Iyy*Izz*cos(theta)^2 + Ixx*Izz*sin(theta)^2 - Iyy^2*cos(phi)^2*cos(theta)^2 + Iyy^2*cos(phi)^4*cos(theta)^2 - Izz^2*cos(phi)^2*cos(theta)^2 + Izz^2*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*cos(theta)^2 - Ixx*Izz*cos(phi)^2*cos(theta)^2 + 2*Iyy*Izz*cos(phi)^2*cos(theta)^2 - 2*Iyy*Izz*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*sin(theta)^2 - Ixx*Izz*cos(phi)^2*sin(theta)^2 + Iyy^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 + Izz^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 - 2*Iyy*Izz*cos(phi)^2*cos(theta)^2*sin(phi)^2)),                                                                       (cos(phi)*cos(theta)*sin(phi)*sin(theta)*(Iyy - Izz))/(Ixx*Izz*cos(phi)^2 - Ixx*Iyy*cos(phi)^2 - Ixx*Izz + Ixx*Izz*cos(theta)^2 - Iyy*Izz*cos(theta)^2 + Ixx*Izz*sin(theta)^2 - Iyy^2*cos(phi)^2*cos(theta)^2 + Iyy^2*cos(phi)^4*cos(theta)^2 - Izz^2*cos(phi)^2*cos(theta)^2 + Izz^2*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*cos(theta)^2 - Ixx*Izz*cos(phi)^2*cos(theta)^2 + 2*Iyy*Izz*cos(phi)^2*cos(theta)^2 - 2*Iyy*Izz*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*sin(theta)^2 - Ixx*Izz*cos(phi)^2*sin(theta)^2 + Iyy^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 + Izz^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 - 2*Iyy*Izz*cos(phi)^2*cos(theta)^2*sin(phi)^2),                 -(sin(theta)*(Izz + Iyy*cos(phi)^2 - Izz*cos(phi)^2))/(Ixx*Izz*cos(phi)^2 - Ixx*Iyy*cos(phi)^2 - Ixx*Izz + Ixx*Izz*cos(theta)^2 - Iyy*Izz*cos(theta)^2 + Ixx*Izz*sin(theta)^2 - Iyy^2*cos(phi)^2*cos(theta)^2 + Iyy^2*cos(phi)^4*cos(theta)^2 - Izz^2*cos(phi)^2*cos(theta)^2 + Izz^2*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*cos(theta)^2 - Ixx*Izz*cos(phi)^2*cos(theta)^2 + 2*Iyy*Izz*cos(phi)^2*cos(theta)^2 - 2*Iyy*Izz*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*sin(theta)^2 - Ixx*Izz*cos(phi)^2*sin(theta)^2 + Iyy^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 + Izz^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 - 2*Iyy*Izz*cos(phi)^2*cos(theta)^2*sin(phi)^2);...
   0,    0,                                                                                             0,                                                                                                                                                                                                                                                                                                                                                                                                                               (Iyy*cos(phi)*cos(theta)*sin(phi)*sin(theta) - Izz*cos(phi)*cos(theta)*sin(phi)*sin(theta))/(Ixx*Izz*cos(phi)^2 - Ixx*Iyy*cos(phi)^2 - Ixx*Izz + Ixx*Izz*cos(theta)^2 - Iyy*Izz*cos(theta)^2 + Ixx*Izz*sin(theta)^2 - Iyy^2*cos(phi)^2*cos(theta)^2 + Iyy^2*cos(phi)^4*cos(theta)^2 - Izz^2*cos(phi)^2*cos(theta)^2 + Izz^2*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*cos(theta)^2 - Ixx*Izz*cos(phi)^2*cos(theta)^2 + 2*Iyy*Izz*cos(phi)^2*cos(theta)^2 - 2*Iyy*Izz*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*sin(theta)^2 - Ixx*Izz*cos(phi)^2*sin(theta)^2 + Iyy^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 + Izz^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 - 2*Iyy*Izz*cos(phi)^2*cos(theta)^2*sin(phi)^2), -(Ixx - Ixx*cos(theta)^2 + Iyy*cos(theta)^2 - Ixx*sin(theta)^2 - Iyy*cos(phi)^2*cos(theta)^2 + Izz*cos(phi)^2*cos(theta)^2)/(Ixx*Izz*cos(phi)^2 - Ixx*Iyy*cos(phi)^2 - Ixx*Izz + Ixx*Izz*cos(theta)^2 - Iyy*Izz*cos(theta)^2 + Ixx*Izz*sin(theta)^2 - Iyy^2*cos(phi)^2*cos(theta)^2 + Iyy^2*cos(phi)^4*cos(theta)^2 - Izz^2*cos(phi)^2*cos(theta)^2 + Izz^2*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*cos(theta)^2 - Ixx*Izz*cos(phi)^2*cos(theta)^2 + 2*Iyy*Izz*cos(phi)^2*cos(theta)^2 - 2*Iyy*Izz*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*sin(theta)^2 - Ixx*Izz*cos(phi)^2*sin(theta)^2 + Iyy^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 + Izz^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 - 2*Iyy*Izz*cos(phi)^2*cos(theta)^2*sin(phi)^2), (Iyy*cos(phi)*cos(theta)*sin(phi) - Izz*cos(phi)*cos(theta)*sin(phi))/(Ixx*Izz*cos(phi)^2 - Ixx*Iyy*cos(phi)^2 - Ixx*Izz + Ixx*Izz*cos(theta)^2 - Iyy*Izz*cos(theta)^2 + Ixx*Izz*sin(theta)^2 - Iyy^2*cos(phi)^2*cos(theta)^2 + Iyy^2*cos(phi)^4*cos(theta)^2 - Izz^2*cos(phi)^2*cos(theta)^2 + Izz^2*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*cos(theta)^2 - Ixx*Izz*cos(phi)^2*cos(theta)^2 + 2*Iyy*Izz*cos(phi)^2*cos(theta)^2 - 2*Iyy*Izz*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*sin(theta)^2 - Ixx*Izz*cos(phi)^2*sin(theta)^2 + Iyy^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 + Izz^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 - 2*Iyy*Izz*cos(phi)^2*cos(theta)^2*sin(phi)^2);...
   0,    0,                                                                                             0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -(sin(theta)*(Izz + Iyy*cos(phi)^2 - Izz*cos(phi)^2))/(Ixx*Izz*cos(phi)^2 - Ixx*Iyy*cos(phi)^2 - Ixx*Izz + Ixx*Izz*cos(theta)^2 - Iyy*Izz*cos(theta)^2 + Ixx*Izz*sin(theta)^2 - Iyy^2*cos(phi)^2*cos(theta)^2 + Iyy^2*cos(phi)^4*cos(theta)^2 - Izz^2*cos(phi)^2*cos(theta)^2 + Izz^2*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*cos(theta)^2 - Ixx*Izz*cos(phi)^2*cos(theta)^2 + 2*Iyy*Izz*cos(phi)^2*cos(theta)^2 - 2*Iyy*Izz*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*sin(theta)^2 - Ixx*Izz*cos(phi)^2*sin(theta)^2 + Iyy^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 + Izz^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 - 2*Iyy*Izz*cos(phi)^2*cos(theta)^2*sin(phi)^2),                                                                                  (cos(phi)*cos(theta)*sin(phi)*(Iyy - Izz))/(Ixx*Izz*cos(phi)^2 - Ixx*Iyy*cos(phi)^2 - Ixx*Izz + Ixx*Izz*cos(theta)^2 - Iyy*Izz*cos(theta)^2 + Ixx*Izz*sin(theta)^2 - Iyy^2*cos(phi)^2*cos(theta)^2 + Iyy^2*cos(phi)^4*cos(theta)^2 - Izz^2*cos(phi)^2*cos(theta)^2 + Izz^2*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*cos(theta)^2 - Ixx*Izz*cos(phi)^2*cos(theta)^2 + 2*Iyy*Izz*cos(phi)^2*cos(theta)^2 - 2*Iyy*Izz*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*sin(theta)^2 - Ixx*Izz*cos(phi)^2*sin(theta)^2 + Iyy^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 + Izz^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 - 2*Iyy*Izz*cos(phi)^2*cos(theta)^2*sin(phi)^2),                              -(Izz + Iyy*cos(phi)^2 - Izz*cos(phi)^2)/(Ixx*Izz*cos(phi)^2 - Ixx*Iyy*cos(phi)^2 - Ixx*Izz + Ixx*Izz*cos(theta)^2 - Iyy*Izz*cos(theta)^2 + Ixx*Izz*sin(theta)^2 - Iyy^2*cos(phi)^2*cos(theta)^2 + Iyy^2*cos(phi)^4*cos(theta)^2 - Izz^2*cos(phi)^2*cos(theta)^2 + Izz^2*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*cos(theta)^2 - Ixx*Izz*cos(phi)^2*cos(theta)^2 + 2*Iyy*Izz*cos(phi)^2*cos(theta)^2 - 2*Iyy*Izz*cos(phi)^4*cos(theta)^2 + Ixx*Iyy*cos(phi)^2*sin(theta)^2 - Ixx*Izz*cos(phi)^2*sin(theta)^2 + Iyy^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 + Izz^2*cos(phi)^2*cos(theta)^2*sin(phi)^2 - 2*Iyy*Izz*cos(phi)^2*cos(theta)^2*sin(phi)^2)];
 

end

